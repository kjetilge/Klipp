// ****************** MAIN PLAYER LAYOUT TEMPLATE ******************
template(name="player")      
  div(class="left")
    +Template.dynamic(template=videoArea)
    +Template.dynamic(template=toolbarArea)
    //+Template.dynamic(template=chaptersArea)

  div(class="right")
    +Template.dynamic(template=issueNavArea)
    +Template.dynamic(template=videoNavArea)



// ****************** SUB TEMPLATES ******************

// HTML5 PLAYER
template(name="html5Player")
  div
    if Template.subscriptionsReady
      video(id="video" type="video/mp4" src="{{videoUrl}}" poster="{{posterImageUrl}}" controls crossOrigin="Anonymous" width="600")
    else Template.subscriptionsReady
      h1 loading ..
    

    
// Issue (Utgave)
template(name="issueNav")
  div(id="issue-nav")
    div(id="issue-actions")
      if showOnlyCurrentIssue
        button(class="toggle-issue-browser") Vis Tidligere utgaver
      else
        button(class="toggle-issue-browser") Vis kun siste utgave
      
      button(class="add-issue") Legg til utgave
      
    +each issueItems
      +issueItem

template(name="issueItem")
  div(class="card")
    a(href="{{pathFor '/utgave/:issue/kurs/:video' issue=_id video=firstVideo._id}}")
      div(class="issue-select card-image" id="{{_id}}")
        img(src="{{frontSplashSmall}}" class="frontSplashSmall")
        span(class="card-title") {{title}}
    div(class="card-content")
      //div(class="itemActions")
      div(class='title')
        |{{> editableText collection="issues" field="title"}}
      button(class="remove-issue") X
      | publisert:
      input(type="checkbox" name="publisert" value="{{published}}")






// VIDEO NAV
template(name="videoNav")
  div(id="video-nav")
    div(id="video-nav-header")
      h3 Innhold
    //Button to add videos
    div(id="video-actions")
      button(class="add-video") Legg til video  
    //List of videos
    +each videos
      +videoNavItem

template(name="videoNavItem")
  a(href="{{pathFor '/utgave/:issue/kurs/:video' issue=issueId video=_id}}")
    div(class="video-select" id="{{_id}}")
      +if splashId
        img(src="{{splashSmall}}" width="100px")
      +else
        img(class="preview" src="/images/no-video.jpg" width="100px")
      div(class='title') {{> editableText collection="videos" field="title"}}
      div(class='filename') {{fileName}}
    
  div(class="itemActions")
     button(class="remove-video") X





// CHAPTERS
template(name="chapters")
  div(id="chapters")
    +each chapters
      +chapter

template(name="chapter")
  span(class="chapter" style="display: inline-block")
    div
      button(class="delete") X
    +if url store="chapterImage"
      img(src="{{url store='chapterImage'}}")
    +else
      img(src="/uploading.png")
      unless isUploaded
        p(class="uploadProgress") uploading..{{uploadProgress}}%
      else
        p(class="uploadProgress") processing..
    div
      span(class='title') {{> editableText collection="cfs.chapters.filerecord" field="title"}}
      button(class="adjust-time") Time
      button(class="adjust-image") Img



//VIDEO MISSING
template(name="videoNotFound")
  if Template.subscriptionsReady
    if issue
      h1 Videoen har blitt slettet eller lenken er feil
      p GÃ¥ til
        a(href="{{pathFor '/utgave/:issue/kurs/:video' issue=issue._id video=issue.firstVideoId}}") videoavspiller
    else
      h1 Ingen video funnet
      button Opprett video

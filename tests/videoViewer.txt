if (JWPlayer.loaded()) {
  playerInstance = jwplayer('playa');
  //console.log("Player loaded!")
  $('video,audio').mediaelementplayer(/* Options */);
  /*
  playerInstance.setup({
    file: 'http://fagfilm-zencoder.s3.amazonaws.com/mp4High/mxa2gxauuMQRYMRgW.mp4',
    aspectratio: '16:9',
    width: "100%",
    autostart: true,
    stretching: 'bestfit'
  });*/

//1:1, 4:3, 16:9, 16:10 2.4:1
/*
  $('.media').click(function(){
      playerInstance.load([{file: $(this).text()}]);
      playerInstance.on('play', function () {
        console.log("PLAYING")
        //ensureAspect(playerInstance);
      }, this)

  })*/
  /*
  playerInstance.on('meta', function () {
    //ensureAspect(playerInstance);
    //playerInstance.setup({file: file, aspectratio: '2.4:1'})
  })*/
}
});
ensureAspect = function (playerInstance) {
//console.log("Meta!")
var video = $("video").get(0);
//console.log("w/h", video.videoWidth, video.videoWidth)
playerAspect = getAspect(playerInstance.getWidth() / playerInstance.getHeight())
videoAspect = getAspect(video.videoWidth / video.videoHeight);

console.log('aspectRatios video / player:'+ videoAspect + " = " + playerAspect);
if (playerAspect !== videoAspect) {
  var file = playerInstance.getPlaylistItem().file;
  console.log("chnage aspect!", file, videoAspect)
  playerInstance.setup({
    file: file ,
    width: '100%',
    height: 'auto',
    aspectratio: "100%",
    autostart: true
  });
}
}


getAspect = function (n) {
//console.log("aspect no", n)
if (n < 1.1) {
  return '1:1';
}
else if (n < 1.4) {
  //console.log(n + "is lower than"+ 1.4)
  return '4/3';
}
else if (n < 1.7) {
  //console.log(n + "is lower than"+ 1.7)
  return '16:10';
}
else if (n < 2.1) {
  //console.log(n + "is lower than"+ 2.1)
  return '16:9';
}

else {
  return '2.4:1';
}
}
/*
$('.media').click(function(){
  console.log("video switch")
  playerInstance.load([{file: $(this).text()}]);
})
*/
/*
jwplayer().on('firstFrame')', function () {
console.log("ready")
}*/
/*
VIDEO_HEIGHT = $("video").height();
setTimeout(function(){
$("#chapter-nav").height(VIDEO_HEIGHT);
console.log("adjust hight")
}, 3500);*/
}

Template.videoViewer.created = function () {
console.log("video created") //loadedmetadata
video = $("video");


/*
video.addEventListener('loadedmetadata', function(e)
{
console.log("video loaded")

}, false);
*/
